<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Movimientos de Préstamo</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    
    
</head>
<body>
    <!-- Menú Superior -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <a class="navbar-brand" href="#">Préstamos</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav mr-auto">
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Clientes
                    </a>
                    <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                        <a class="dropdown-item" href="{{ url_for('auth.home') }}">Ver Clientes</a>
                        <a class="dropdown-item" href="{{ url_for('auth.historial_cliente') }}">Historial Clientes</a>
                        <a class="dropdown-item" href="{{ url_for('auth.add_cliente') }}">Agregar Cliente</a>
                    </div>
                </li>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="prestamosDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Préstamos
                    </a>
                    <div class="dropdown-menu" aria-labelledby="prestamosDropdown">
                        <a class="dropdown-item" href="{{ url_for('prestamos.ver_prestamos') }}">Ver Préstamos</a>
                        <a class="dropdown-item" href="{{ url_for('prestamos.agregar_prestamo') }}">Agregar Préstamo</a>
                    </div>
                </li>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Semanas
                    </a>
                    <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                        <a class="dropdown-item" href="{{ url_for('prestamos.catalogo_semanas') }}">Catálogo de Semanas</a>
                    </div>
                </li>
            </ul>
            <ul class="navbar-nav ml-auto">
                <li class="nav-item">
                    <a class="nav-link" href="{{ url_for('auth.logout') }}">Cerrar Sesión</a>
                </li>
            </ul>
        </div>
    </nav>


    <!-- Contenido Principal -->
    <div class="container mt-5" id="containertabla">
        <h2 class="mb-4">Movimientos del Préstamo</h2>
        <div class="card mb-4">
            <div class="card-body" id="infoPrestamo">
                <p><strong>Solicitante:</strong> {{ cliente_nombre}}</p>
                <p><strong>Total Prestamo:</strong> ${{ Cantidad}}</p>
                <p><strong>Total a Pagar:</strong> ${{ CantidadPagar}}</p>
                <!-- <p><strong>Total Prestamo con Multas:</strong> ${{ cantidadCmulta}}</p> -->
                <p><strong>Semanas Totales:</strong> {{ Semanas }}</p>
                <p><strong>Fecha Inicio:</strong> {{ fecha_inicio }}</p>
                <p><strong>Fecha Termino:</strong> {{ fecha_termino }}</p>
                {% if estado != 'Pagado'%}
                    <button type="button" class="btn btn-success no-pdf" data-toggle="modal" data-target="#agregarPagoModal">
                        Agregar Nuevo Pago
                    </button>
                {%endif%}
            </div>
        </div>
        <div class="d-flex justify-content-between">
           <button id="btnDescargarPDF" class="btn btn-primary">Descargar PDF de Movimientos</button>
        </div>
        <div class="table-responsive able-responsive-sm">
            <table class="table table-bordered table-striped"  id="tabla-movimientos">
                <thead class="thead-light">
                    <tr>
                        <th>Semana</th>
                        <th>Fecha de Pago</th>
                        <th>Pago</th>
                        <th>Multa</th>
                        <th>Pago con Multa</th>
                        <th>Saldo prestamo</th>
                        <th>Saldo Con multa</th>
                        <th class="no-pdf">Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    {% if movimientos %}
                        {% for movimiento in movimientos %}
                        <tr>
                            <td >{{ movimiento.semana }}</td>
                            <td >{% if movimiento.fechaPago %}
                                {{ movimiento.fechaPago.strftime('%d/%m/%Y') }}
                              {% else %}
                                Sin fecha
                              {% endif %}  </td>
                            <td >${{ '{:,.2f}'.format(movimiento.monto) }}</td>
                            <td class="{% if  movimiento.BitMulta %}bg-danger {% else %}bg-success{% endif %} text-white">${{ '{:,.2f}'.format(movimiento.multa) }}</td>
                            <td >${{ '{:,.2f}'.format(movimiento.montoCmulta) }}</td>
                            <td >${{ '{:,.2f}'.format(movimiento.totalPen) }}</td>
                            <td >${{ '{:,.2f}'.format(movimiento.totalCMulta) }}</td>
                            <td class="no-pdf">
                                <a href="{{ url_for('prestamos.eliminar_movimiento', movimiento_id=movimiento.id , prestamo_id=prestamo_id) }}" class="btn btn-danger" title="Eliminar"><i class="fas fa-trash"></i></a>
                                <button class="btn btn-primary btn-imprimir" 
                                        data-semana="{{ movimiento.semana }}"
                                        data-fechapago="{% if movimiento.fechaPago %}{{ movimiento.fechaPago.strftime('%d/%m/%Y') }}{% else %}Sin fecha{% endif %}"
                                        data-pago="{{ '{:,.2f}'.format(movimiento.monto) }}"
                                        data-multa="{{ '{:,.2f}'.format(movimiento.multa) }}"
                                        data-pagomulta="{{ '{:,.2f}'.format(movimiento.montoCmulta) }}"
                                        data-saldoprestamo="{{ '{:,.2f}'.format(movimiento.totalPen) }}"
                                        data-saldomulta="{{ '{:,.2f}'.format(movimiento.totalCMulta) }}"
                                        title="Imprimir Ticket">
                                    <i class="fas fa-print"></i>
                                </button>
                            </td>
                            
                            
                        </tr>
                        {% endfor %}
                    {% else %}
                        <tr>
                            <td colspan="7" class="text-center">No hay movimientos registrados para este préstamo.</td>
                        </tr>
                    {% endif %}
                </tbody>
                
                
                
            </table>
        </div>
        
        
    </div>
    <div id="ticket-template" style="display:none; width:300px; font-family: Arial, Helvetica, sans-serif; background-image: url('../temp/Logo.png');
    background-size: 200px;
    background-repeat: no-repeat;
    background-position: center;
    opacity:1;">
        <div class="ticket" style="padding:12px; box-sizing:border-box; width:100%;">
            <div class="logo" style="text-align:center; margin-bottom:6px;">
            <!-- Si tienes logo, pon aquí un <img> con style="max-width:120px" -->
            <strong style="font-size:16px;">NOMBRE DE MI TIENDA</strong><br>
            <small>RFC · Dirección · Tel: 55-5555-5555</small>
            </div>

            <hr style="border:none; border-top:1px dashed #333; margin:8px 0;">

            <div style="text-align:center; margin-bottom:6px;">
            <strong style="font-size:13px;">Comprobante de Pago</strong><br>
            <small id="ticket-fecha-emision">01/01/2025 12:00</small>
            </div>

            <div style="margin:6px 0; font-size:12px;">
            <div style="display:flex; justify-content:space-between;">
                <div>Semana:</div><div id="ticket-semana">1</div>
            </div>
            <div style="display:flex; justify-content:space-between;">
                <div>Fecha de Pago:</div><div id="ticket-fechaPago">01/01/2025</div>
            </div>
            <div style="display:flex; justify-content:space-between;">
                <div>Pago:</div><div id="ticket-pago">$0.00</div>
            </div>
            <div style="display:flex; justify-content:space-between;">
                <div>Multa:</div><div id="ticket-multa">$0.00</div>
            </div>
            <div style="display:flex; justify-content:space-between;">
                <div>Pago c/ Multa:</div><div id="ticket-pagomulta">$0.00</div>
            </div>
            <div style="display:flex; justify-content:space-between; margin-top:6px; font-weight:700;">
                <div>Saldo:</div><div id="ticket-saldo">$0.00</div>
            </div>
            </div>

            <hr style="border:none; border-top:1px dashed #333; margin:8px 0;">

            <div style="font-size:11px; text-align:center; margin-bottom:6px;">
            <div>Lugar: <span id="ticket-lugar">San Felipe Gto.</span></div>
            <div>Atendido por: <span id="ticket-asesor">Asesor</span></div>
            </div>

            <div style="margin-top:8px; font-size:10px; text-align:center;">
            <div>Gracias por su pago</div>
            <div style="margin-top:6px;">________________________</div>
            <div style="font-size:9px;">Firma</div>
            </div>
        </div>
        </div>
    <!-- Modal para Agregar Pago -->
    <div class="modal fade" id="agregarPagoModal" tabindex="-1" role="dialog" aria-labelledby="agregarPagoModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="agregarPagoModalLabel">Agregar Nuevo Pago</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <form method="POST" action="{{ url_for('prestamos.agregar_pago', prestamo_id=prestamo_id) }}">
                    <div class="modal-body">
                        <div class="form-group">
                            <label for="monto">Monto a Pagar</label>
                            <input type="number" class="form-control" id="monto" name="monto" step="0.01" required value="{{PagoxSemana}}">
                        </div>

                        {% if not es_lunes %}
                        <div class="mb-3">
                            <label class="form-label">Multa por no pagar en lunes:</label>
                            <label class="form-label bg-danger text-white">${{multa_semanas}}</label>
                        </div>
                        <div class="form-check mb-3">
                            <input class="form-check-input" type="checkbox" id="aplicarMulta" value="Aplica"  name="aplicar_Multa" checked>
                            <label class="form-check-label" for="aplicarMulta">Aplicar Multa</label>
                        </div>
                        {% endif %}

                        <div class="form-group">
                            <label for="fecha" class="form-label">Fecha Pago:</label>
                            <label id="Solicitante" class="form-label d-none">{{ cliente_nombre}}</label>
                            <label id="TotalPrestamo" class="form-label d-none">${{ CantidadPagar}}</label>
                            <input type="date" id="fecha" name="fechaPago" class="form-control" required>
                        </div>
                    </div>

                    <div class="modal-footer">
                        <button type="submit" class="btn btn-primary">Registrar Pago</button>
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>
                    </div>
                </form>

            </div>
        </div>
    </div>

    <!-- Scripts de Bootstrap y jQuery -->
    <script>
        // Función para habilitar el input
        function habilitarInput() {
            const input = document.getElementById('monto');
            if (input.disabled) {
                // Si está deshabilitado, habilítalo
                input.disabled = false;
                input.focus(); // Opcional: enfocar el input
                boton.innerHTML = '<i class="fas fa-lock"></i> Bloquear';
                boton.classList.remove('btn-primary');
                boton.classList.add('btn-danger');
            } else {
                // Si está habilitado, deshabilítalo
                input.disabled = true;
                boton.innerHTML = '<i class="fas fa-edit"></i> Editar';
                boton.classList.remove('btn-danger');
                boton.classList.add('btn-primary');
            }         // Opcional: enfocar el input
        }

       document.getElementById('btnDescargarPDF').addEventListener('click', () => {
             const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            let y = 20; // posición vertical inicial

            // --- Información del préstamo ---
            const infoDiv = document.getElementById('infoPrestamo');
            infoDiv.querySelectorAll('p').forEach(p => {
                doc.setFontSize(10);
                doc.text(p.innerText, 14, y);
                y += 7; // espacio entre líneas
            });

            y += 5; // un poco de espacio antes de la tabla

            // --- Tabla de movimientos ---
            const table = document.getElementById('tabla-movimientos');
            const headers = [];
            const data = [];

            // Cabecera
            table.querySelectorAll('thead th').forEach(th => {
                if (!th.classList.contains('no-pdf')) headers.push(th.innerText);
            });

            // Filas
            table.querySelectorAll('tbody tr').forEach(tr => {
                const row = [];
                tr.querySelectorAll('td').forEach(td => {
                if (!td.classList.contains('no-pdf')) row.push(td.innerText);
                });
                data.push(row);
            });

            doc.autoTable({
                startY: y,
                head: [headers],
                body: data,
                theme: 'grid',
                styles: { fontSize: 10 },
                headStyles: { fillColor: [41, 128, 185], textColor: 255 },
                margin: { left: 14, right: 14 }
            });

            const url = doc.output('bloburl');
            window.open(url, '_blank');
            });

       document.addEventListener('click', function(e){
            const btn = e.target.closest('.btn-imprimir');
            if (!btn) return;

            const Solicitante= document.getElementById('Solicitante').textContent;
            const TotalPrestamo= document.getElementById('TotalPrestamo').textContent;

            const { jsPDF } = window.jspdf;
            const doc = new jsPDF({
                unit: 'mm',
                format: [80, 200] // ancho típico de ticket 80mm, alto inicial 200mm
            });

            // Datos del movimiento
            const semana = btn.getAttribute('data-semana') || '';
            const fechaPago = btn.getAttribute('data-fechapago') || '';
            const pago = btn.getAttribute('data-pago') || '0.00';
            const multa = btn.getAttribute('data-multa') || '0.00';
            const pagoMulta = btn.getAttribute('data-pagomulta') || '0.00';
            const saldoPrestamo = btn.getAttribute('data-saldoprestamo') || '0.00';
            const lugar = 'San Felipe Gto.';
            const asesor = btn.getAttribute('data-asesor') || 'Asesor';

            const saldoPrestamoS = parseFloat(saldoPrestamo.replace(/,/g, ''));
            const pagoS = parseFloat(pago.replace(/,/g, ''));

            const saldoAnterior = ( saldoPrestamoS +  pagoS).toFixed(2);


  // "1300.00"

            let saldoAnteriorFormateado = Number(saldoAnterior)
                .toLocaleString("es-MX", {
                    minimumFractionDigits: 2,
                    maximumFractionDigits: 2
                });

            console.log(saldoAnteriorFormateado); 


            const marcaAgua = "data:image/png;base64,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";
            // Posición vertical inicial
            let y = 10;
            doc.setGState(new doc.GState({ opacity: 0.1 }));
            doc.addImage(marcaAgua, "PNG", 10, 40, 60, 60);
            doc.setGState(new doc.GState({ opacity: 1 }));
            // --- Encabezado ---
            doc.setFontSize(12);
            doc.setFont("helvetica", "bold");
            doc.text("PRESTAMO", 40, y, {align: "center"});
            y += 6;
            doc.setFontSize(9);
            doc.setFont("helvetica", "normal");
            doc.text("RFC · Dirección · Tel: 55-5555-5555", 40, y, {align: "center"});
            y += 6;
            doc.setLineWidth(0.3);
            doc.line(5, y, 75, y); // línea horizontal
            y += 5;

            // --- Título ---
            doc.setFontSize(11);
            doc.setFont("helvetica", "bold");
            doc.text("COMPROBANTE DE PAGO", 40, y, {align: "center"});
            y += 6;

            // Fecha de emisión
            const fechaHoy = new Date().toLocaleString();
            doc.setFontSize(9);
            doc.setFont("helvetica", "normal");
            doc.text(`Fecha: ${fechaHoy}`, 5, y);
            y += 5;
            doc.text(`Lugar: ${lugar}`, 5, y);
            y += 6;
            doc.text(`Cliente: ${Solicitante}`, 5, y);
            y += 6;

            // --- Datos del movimiento ---
            doc.setFont("helvetica", "bold");
            doc.text("Semana", 5, y);
            doc.text("Fecha Pago", 28, y);
            doc.text("Pago", 65, y, {align:"right"});
            y += 4;
            doc.setLineWidth(0.1);
            doc.line(5, y, 75, y); // línea separadora
            y += 5;

            doc.setFont("helvetica", "normal");
            doc.text(`${semana}`, 5, y);
            doc.text(`${fechaPago}`, 28, y);
            doc.text(`$${pago}`, 67, y, {align:"right"});
            y += 10;
            doc.setFont("helvetica", "bold");
            doc.text(`Saldo Anterior: $${saldoAnteriorFormateado}`, 5, y);
            y += 6;
            doc.text(`Saldo Actual: $${saldoPrestamo}`, 5, y);
            y += 6;
            doc.line(5, y, 75, y); // línea separadora
            y += 6;

            // --- Pie ---
            doc.setFont("helvetica", "normal");
            doc.setFontSize(9);
            doc.text("Atendido por: Martín Cano" , 5, y);
            y += 8;
            doc.text("Gracias por su pago", 40, y, {align:"center"});
            y += 12;
            doc.line(20, y, 60, y); // línea de firma
            y += 4;
            doc.setFontSize(8);
            doc.text("Firma", 40, y, {align:"center"});
            y += 6;

            doc.setFontSize(7);
            doc.text("", 40, y, {align:"center"});

            // Abrir PDF en nueva pestaña
            const url = doc.output('bloburl');
            window.open(url, '_blank');
            });  
    </script>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.0.6/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
</body>
</html>
